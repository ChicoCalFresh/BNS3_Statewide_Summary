---
title: "Student Demographics"
output: 
  html_document: 
    toc: yes
    toc_float: yes
    css: styles.css
editor_options: 
  chunk_output_type: console
---

```{r, include=FALSE}
source("common_code.R")
bns <- bns %>%
  mutate(school_split = fct_collapse(school,
                                     "CC" = c("Allan Hancock Community College",
                                              "Butte CC",
                                              "Clovis CC",
                                              "Mt. SAC CC",
                                              "Palo Verde CC"),
                                     "State" = c("Cal State LA",
                                                 "Cal State San Bernardino",
                                                 "CSU Bakersfield",
                                                 "CSU Dominguez Hills",
                                                 "Sacramento State",
                                                 "San Francisco State"),
                                     "UC" = c("UC Berkeley")))

#rename to be consistent with code book
bns <- bns %>% 
  mutate(school_rnm = recode(school, "Butte CC"="Butte College", 
                       "Mt. SAC CC" = "Mt. San Antonio College",
                       "Clovis CC" = "Clovis Community College",
                       "Palo Verde CC" = "Palo Verde College",
                   "Allan Hancock Community College" = "Allan Hancock College"))

```

The following set of questions were asked in regards to the students' academic status. This includes information such as what college they are currently enrolled in, their class standing, major, GPA, and enrolled units. They were also asked questions about programs they participate in as well as what type of student they are (transfer, international, etc.) to help identify students.

<br>

## School

**Which campus do you attend? `r print_n_reporting('school')`**

<div class = "row">

<div class = "col-md-7">

```{r}
#| fig-height: 6
#| fig-width: 8
plot_frq(bns$school_rnm, ylim=c(0,450), hjust = -.2, vjust = "center",
         coord.flip = TRUE) + xlab('') + ylab("Frequency")
```

Twelve campuses participated in this statewide survey. Of the twelve campuses, five were community colleges, six were California State Universities, and one was a University of California. The majority of students (`r unname(table(bns$school_split)[2])`) were currently enrolled in a state school. Fewer students (`r unname(table(bns$school_split)[1])`) reported enrollment in a community college, and a small minority (`r unname(table(bns$school_split)[3])`) reported enrollment in a UC. <br>

consider using ggdotchart and color/org by sector https://rpkgs.datanovia.com/ggpubr/reference/ggdotchart.html (this is a note for Robin and Saul to do. leave it.)

## Class Standing

**Estimate your class standing by units completed `r print_n_reporting('q15')`**

<div class = "row">

<div class = "col-md-7">

```{r}
#| fig-height: 4.5
#| fig-width: 5.5
tmp <- recode(bns$q15,
              "Freshman (0-29 semester units or 0-44 quarter units)" = "Freshman",
              "Sophomore (30-59 semester units or 45-89 quarter units)" = "Sophmore",
              "Junior (60-89 semester units or 90-134 quarter units)" = "Junior",
              "Senior (90+ semester units or 135+ quarter units)" = "Senior")
              
plot_frq(tmp, wrap.labels = 8, ylim=c(0,750)) + xlab('Class Standing') + 
  ylab("Frequency")
```

The Statewide survey captures students of all class standing. Of the `r sum(table(bns$q15))` respondents, there were `r unname(table(tmp)[1])` freshmen, `r unname(table(tmp)[2])` sophomores, `r unname(table(tmp)[3])` juniors, and `r unname(table(tmp)[4])` seniors.

## Major

**Which of the following categories best describes your major? `r print_n_reporting('q16')`**

```{r}
#| fig-height: 6
#| fig-width: 8.5
bns <- bns %>% mutate(q16=recode(q16, 
                                 "Science, Technology, Engineering and Math (STEM) (Includes Medicine, Computer Science, Agriculture, Accounting, Statistics, Nursing, and Nutrition)" = "Science, Technology, Engineering and Math (STEM)"))

plot_frq(bns$q16, ylim=c(0,875), wrap.labels = 16, sort.frq = 'desc') + xlab('') + ylab("Frequency") + theme(axis.text.x = element_text(size = 10))

```

*NOTE: Science, Technology, Engineering and Math (STEM) was shortened for the figure above, but also includes the following majors: Medicine, Computer Science, Agriculture, Accounting, Statistics, Nursing, and Nutrition.*

The majority of students in the data are majoring in a `r names(sort(table(bns$q16), decreasing=TRUE)[1])` program (`r unname(sort(table(bns$q16), decreasing=TRUE)[1])` people). `r unname(sort(table(bns$q16), decreasing=TRUE)[2])` of the students are `r names(sort(table(bns$q16), decreasing=TRUE)[2])` majors.

<br />

## Overall GPA

**What is your approximate overall grade point average (GPA)? `r print_n_reporting('q17')`**

```{r}
#| fig-height: 4
#| fig-width: 5.5
bns$gpa_fac <- cut(bns$q17, breaks = c(0, 1.5, 2.0, 2.5, 3.0, 3.5, 5.0), labels = c("1.5 or less", "1.51-2.0", "2.01-2.5", "2.51-3.0", "3.01-3.5", "3.51 or above"), ordered_result = TRUE, include.lowest = TRUE)

plot_frq(bns$gpa_fac) + xlab('GPA') + ylab("Frequency")
```

The average overall GPA for students is `r round(mean(bns$q17, na.rm = TRUE), 2)`, while the median is `r round(median(bns$q17, na.rm = TRUE), 2)`. The majority (`r percent(sum(prop.table(table(bns$gpa_fac))[5:6]), accuracy = .1)`) of students have a GPA greater than 3.0.

<br />

## Currently Enrolled Units

**How many units are you currently taking? `r print_n_reporting('q18')`**

```{r}
# #| fig-height: 3.4
# #| fig-width: 7
gghistogram(bns, x = "q18", add = "mean", fill = chc_blue, alpha = 1) + 
  xlab("Units") + ylab("Frequency")


# unit outliers (click up)
# cutoff at 30?
```

The average number of units a student is enrolled in is `r round(mean(bns$q18, na.rm = TRUE), 2)` units, while the median is `r median(bns$q18, na.rm = TRUE)` units. The majority of students are considered full-time (12 or more units), with `r names(sort(table(bns$q18), decreasing=TRUE)[1])` units being the highest occurring and `r names(sort(table(bns$q18), decreasing=TRUE)[2])` units being the second highest occurring.

<br />

## Student Identifiers

The following tables contain separate questions that were asked as a series of Yes/No responses to help further understand students. They were grouped together in this page by the start of the question.

### I identify as...

```{r}
questions <- c(paste0('q14_', 1:3), paste0('q14_', 5:12))
rnames <- c("A Transfer Student", "LGBTQA+", "A student with a disability", "A former foster youth/child",
            "An International student", "A non-California resident (not International)",
            "An ESL (English as a Second Language) student",
            "A Veteran of military service",
            "A student athlete",
            "A DREAM (i.e. undocumented) student",
            "A DACA (i.e. Deferred Action for Childhood Arrivals) student")
binary_table(questions, "Yes", rnames, ".")
```

### Disability Support Services

*Note*: This name varies by campus and may not always be called the Disability Support Service Center.

```{r}
#| fig-height: 5
#| fig-width: 7
questions <- paste0('q14_', 3:4)
rnames <- c('I identify as a student with a disability',
          'I receive services through my campus for a disability')
            
binary_table(questions, "Yes", rnames, "")
```
