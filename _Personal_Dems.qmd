---
title: "Demographics"
---

```{r, include=FALSE}
source("common_code.R")
```

# Personal Demographics

The following set of questions were asked in regards to the students' personal demographics. This includes the students' age, ethnicities they identify with, and the number of dependents they are responsible for taking care of. They were also asked about parents' education, which will help us identify first generation college students.

## Age

*The following was determined by taking the difference between birth date and the time at which the survey was completed `r print_n_reporting('age')`*

```{r}
gghistogram(bns, x = "age", add = "mean", alpha = 1, fill = chc_blue) + 
  xlab("Age") + ylab("Count")
```

The age for participants in the survey range from `r min(bns$age, na.rm = TRUE)` to `r max(bns$age, na.rm = TRUE)` at the time of completion, with the majority of participants being between 20-30 years old. The average age of a participant in this survey is `r round(mean(bns$age, na.rm = TRUE),1)` years old. <br />

## Gender Identity

**What is your gender identity? `r print_n_reporting('q7')`**

<div class = "row">

::: col-md-7
```{r}
#| fig-height: 3.5
#| fig-width: 7
rec <- bns %>% mutate(q7=recode(q7, "Gender non-binary"="Non-binary", "Gender Queer or Gender-Nonconforming" = "Queer or Nonconforming", "Gender Unlisted:" = "Unlisted"))


plot_frq(rec$q7, sort.frq="desc") + xlab('Gender') + ylab("Frequency")
#Should we cut "Gender" from the 3 categories on the right? Exp. "Non-binary" instead of "Gender non-binary"
```
:::

Of the survey participants, `r unname(table(bns$q7)['Woman'])` of them identify as a woman, `r unname(table(bns$q7)['Man'])` identify as a man, and `r unname(table(bns$q7)['Gender non-binary'])` identify as gender non-binary. There are also survey participants who preferred not to answer.

## Ethnicity

**In the US Census, Hispanic Origins are not races. Do you identify as Hispanic or Latino or Spanish Origin? `r print_n_reporting('q8')`**

::: row
::: col-md-6
```{r}
#| fig-height: 3
#| fig-width: 4
tmp <- data.frame(q8=bns$q8) %>% mutate(hispanic=as.factor(ifelse(is.na(q8), NA, ifelse(grepl("Yes", q8), "Hispanic", "Non-Hispanic")))) %>% select(-q8)

plot_frq(tmp$hispanic) + xlab("") + ylab("Frequency")
```
:::

::: col-md-5
We define Hispanic Origin to include: Mexican, Mexican American, Chicano, Puerto Rican, or another Hispanic/Latino/Spanish origin. The data indicates that the majority of survey participants identify as having Hispanic Origins (`r unname(table(tmp$hispanic)['Hispanic'])` people), while around a quarter of them do not identify as having Hispanic Origins (`r unname(table(tmp$hispanic)['Non-Hispanic'])` people).
:::
:::

<br />

```{r}
tmp <- data.frame(q8=bns$q8, school=bns$school) %>% 
  mutate(hispanic=as.factor(ifelse(is.na(q8), NA, ifelse(grepl("Yes", q8), "Yes", "No"))),
         school=ifelse(is.na(hispanic), NA, school)) %>% select(-q8)
```

## Race

```{r}

tmp <-
  bns %>% select(starts_with("eth_")) %>% mutate(
    white = ifelse(is.na(eth_white), NA, ifelse(eth_white == 1, 1, 0)),
    black = ifelse(is.na(eth_african_amer), NA, ifelse(eth_african_amer == 1, 1, 0)),
    amer_indian = ifelse(is.na(eth_amer_indian), NA, ifelse(eth_amer_indian == 1, 1, 0)),
    asian = ifelse((
      is.na(eth_chinese) | is.na(eth_filipino) | is.na(eth_asian_indian) |
        is.na(eth_other_asian) |
        is.na(eth_vietnamese) | is.na(eth_korean) |
        is.na(eth_japanese)
    ),
    NA,
    ifelse((
      eth_chinese == 1 | eth_filipino == 1 | eth_asian_indian  == 1 |
        eth_other_asian == 1 |
        eth_vietnamese == 1 | eth_korean == 1 |
        eth_japanese == 1),1,0)
    ),
    hawaiian = ifelse((
      is.na(eth_pacific_islander) |
        is.na(eth_chamorro) | is.na(eth_hawaiian) |
        is.na(eth_samoan)
    ), NA,
    ifelse((
      eth_pacific_islander == 1 | eth_chamorro == 1 | eth_hawaiian == 1 |
        eth_samoan == 1
    ),
    1,
    0
    ))
  ) %>% select(15, 17:21)


```

**What race do you identify as? Select all that apply `r print_n_reporting_tmp('white')`** *Note that the survey included 14 race options that were collapsed down to 5 broad groups defined by [census.gov](https://www.census.gov/quickfacts/fact/note/US/RHI625219).*

```{r}
cnames <- c("Prefer not to answer race", "White", "Black or African American", "American Indian and Alaska Native", "Asian", "Native Hawaiian and Other Pacific Islander")
tmp2 <- tmp %>% na.omit()
colnames(tmp2) <- cnames
tmp2 <- as.data.frame(t(tmp2)) %>% mutate(sums=rowSums(.),
                                          label=paste0(sums, " (", percent(sums/ncol(.), accuracy=0.1), ")")) %>% arrange(desc(sums)) %>% select(label)
colnames(tmp2) <- "Yes (%)"
tmp2 %>% kable() %>% kable_styling(bootstrap_options = "striped")
```

## Dependents

**If you have dependents, then how many of them receive more than 50% of their financial support from you? `r print_n_reporting('q11')`**

```{r}
#| fig-height: 4
#| fig-width: 6
plot_frq(bns$q11) + xlab('Number of Dependents') + ylab("Frequency")
```

The majority of survey participants who report having at least one dependent also report that they provide more than 50% of financial support to at least one dependent (`r nrow(bns[bns$q11 > 0, 'q11'] %>% na.omit())` people).

<br>

## Parents Education

**What is the highest level of education completed by your parents/guardians? `r print_n_reporting('q13')`**

```{r}
#| fig-height: 5
#| fig-width: 7.5
tmp2 <- as.data.frame(table(bns$q13)) %>%
  mutate(Percent=lapply(Freq, function(x) paste0('(', percent(x/sum(!is.na(bns[['q13']])), accuracy = 0.1), ')')),
         FirstGen=as.character(c(1,1,1,1,1,0,0,0,1)),
         Var1=recode(Var1, "Other/Unknown" = "Other/ Unknown")) %>% arrange((desc(Freq)))

ggplot(tmp2, aes(x=factor(Var1, levels=Var1), y=Freq, fill=FirstGen, label=Percent)) + geom_col(colour = "black") +
  scale_fill_manual(values=c("#336699", "#ecf0b7")) + geom_text(aes(y=Freq+50)) + ylim(0,900) +
  scale_x_discrete(labels=label_wrap(10)) +   geom_text(aes(y=Freq + 100, label=Freq)) +
  xlab('') + ylab("Frequency") + theme(legend.position = "none") + theme(axis.text.x = element_text(size = 10))
```

*Note: Variables filled with yellow above are used to show the conditions used to build the First Generation variable*.

The highest level of education completed by most survey participants' parents is "`r names(sort(table(bns$q13), decreasing=TRUE)[1])`" (`r unname(sort(table(bns$q13), decreasing=TRUE)[1])`), while `r unname(sort(table(bns$q13), decreasing=TRUE)[2])` survey participants reported their parents highest level is "`r names(sort(table(bns$q13), decreasing=TRUE)[2])`", and `r unname(sort(table(bns$q13), decreasing=TRUE)[3])` report their parents highest level is "`r names(sort(table(bns$q13), decreasing=TRUE)[3])`". Only a minority of survey participants (`r sum(table(bns$q13)[c("Bachelor's degree", "Master's degree", "Doctorate degree (JD, MD, PhD, EdD., etc.)")])`) indicated that their parents have a bachelor's degree or higher.

### First Generation

*Note: Students with parents education identified as "Other/Unknown" were not marked as first gen or not since they could not be determined.* **`r print_n_reporting('firstgen')`**

::: row
::: col-md-6
```{r}
#| fig-height: 3
#| fig-width: 4
tmp3 <- data.frame(firstgen=bns$firstgen) %>% 
  mutate(firstgen=factor(ifelse(is.na(firstgen), NA, ifelse(firstgen == 0, "Not First Gen", "First Gen")), levels=c("Not First Gen", "First Gen")))

plot_frq(tmp3$firstgen, ylim=c(0, 2300)) + xlab('') + ylab("Frequency")
```
:::

::: col-md-5
`r unname(sort(table(bns$firstgen), decreasing=TRUE)[1])` survey participants are considered as First Generation College students and `r unname(sort(table(bns$firstgen), decreasing=TRUE)[2])` survey participants are not considered First Generation College students.
:::
:::

As defined by the [University of California](https://www.universityofcalifornia.edu/sites/default/files/First-Generation%20Student%20Success%20at%20UC%208-2017.pdf) first generation students are "working to be part of the first generation in their families to earn a four-year university degree". This means based upon parents education, students in the data set are considered first generation if their parents do not have a Bachelor's or Master's degree from a four-year university. From the *Parents Education* graph, all bars highlighted as yellow are considered first gen, while all bars in blue are not (excluding Other/Unknown).

# Academic Characteristics
